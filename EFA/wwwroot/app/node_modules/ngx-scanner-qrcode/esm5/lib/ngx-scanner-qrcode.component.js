/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, EventEmitter, ViewChild, ViewEncapsulation } from '@angular/core';
import { BehaviorSubject, AsyncSubject } from 'rxjs';
import { AS_COMPLETE, BLOB_TO_FILE, CANVAS_TO_BLOB, DRAW_RESULT_APPEND_CHILD, FILES_TO_SCAN, HAS_OWN_PROPERTY, OVERRIDES, PLAY_AUDIO, VIBRATE } from './ngx-scanner-qrcode.helper';
import { CONFIG_DEFAULT, MEDIA_STREAM_DEFAULT } from './ngx-scanner-qrcode.default';
var NgxScannerQrcodeComponent = /** @class */ (function () {
    function NgxScannerQrcodeComponent() {
        /**
         * EventEmitter
         */
        this.event = new EventEmitter();
        /**
         * Input
         */
        this.src = CONFIG_DEFAULT.src;
        this.fps = CONFIG_DEFAULT.fps;
        this.vibrate = CONFIG_DEFAULT.vibrate;
        this.decode = CONFIG_DEFAULT.decode;
        this.isBeep = CONFIG_DEFAULT.isBeep;
        this.deviceActive = CONFIG_DEFAULT.deviceActive;
        this.config = CONFIG_DEFAULT;
        this.constraints = CONFIG_DEFAULT.constraints;
        /**
         * Export
         */
        this.isStart = false;
        this.isLoading = false;
        this.isTorch = false;
        this.data = new BehaviorSubject([]);
        this.devices = new BehaviorSubject([]);
        this.dataForResize = [];
    }
    /**
     * @return {?}
     */
    NgxScannerQrcodeComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.overrideConfig();
        if (this.src) {
            this.loadImage(this.src);
        }
        this.resize();
    };
    /**
     * start
     * @return AsyncSubject
     */
    /**
     * start
     * @return {?} AsyncSubject
     */
    NgxScannerQrcodeComponent.prototype.start = /**
     * start
     * @return {?} AsyncSubject
     */
    function () {
        /** @type {?} */
        var as = new AsyncSubject();
        if (this.isStart) {
            // Reject
            AS_COMPLETE(as, false);
        }
        else {
            // mediaDevices
            this.loadAllDevices(as);
        }
        return as;
    };
    /**
     * playDevice
     * @param deviceId
     * @param as
     * @return AsyncSubject
     */
    /**
     * playDevice
     * @param {?} deviceId
     * @param {?=} as
     * @return {?} AsyncSubject
     */
    NgxScannerQrcodeComponent.prototype.playDevice = /**
     * playDevice
     * @param {?} deviceId
     * @param {?=} as
     * @return {?} AsyncSubject
     */
    function (deviceId, as) {
        var _this = this;
        if (as === void 0) { as = new AsyncSubject(); }
        /** @type {?} */
        var existDeviceId = this.isStart ? this.getConstraints().deviceId != deviceId : true;
        switch (true) {
            case deviceId == 'null' || deviceId == null:
                this.stop();
                AS_COMPLETE(as, false);
                break;
            case deviceId && existDeviceId:
                stop();
                this.stop();
                clearInterval(this.rAF_ID);
                // Loading on
                this.status(false, true);
                /** @type {?} */
                var constraints = {
                    audio: false,
                    video: (typeof (this.constraints && this.constraints.video) === 'boolean') ? { deviceId: deviceId } : Object.assign({ deviceId: deviceId }, this.constraints && this.constraints.video)
                };
                this.deviceActive = this.devices.value.findIndex((/**
                 * @param {?} f
                 * @return {?}
                 */
                function (f) { return f.deviceId == deviceId; }));
                // MediaStream
                navigator.mediaDevices.getUserMedia(constraints).then((/**
                 * @param {?} stream
                 * @return {?}
                 */
                function (stream) {
                    _this.video.nativeElement.srcObject = stream;
                    _this.video.nativeElement.onloadedmetadata = (/**
                     * @return {?}
                     */
                    function () {
                        _this.video.nativeElement.play();
                        _this.requestAnimationFrame();
                        _this.status(true, false);
                        AS_COMPLETE(as, true);
                    });
                })).catch((/**
                 * @param {?} error
                 * @return {?}
                 */
                function (error) {
                    _this.status(false, false);
                    _this.eventEmit(false);
                    AS_COMPLETE(as, false, error);
                }));
                break;
            default:
                AS_COMPLETE(as, false);
                break;
        }
        return as;
    };
    /**
     * stop
     * @return AsyncSubject
     */
    /**
     * stop
     * @return {?} AsyncSubject
     */
    NgxScannerQrcodeComponent.prototype.stop = /**
     * stop
     * @return {?} AsyncSubject
     */
    function () {
        this.eventEmit(null);
        this.status(false, false);
        /** @type {?} */
        var as = new AsyncSubject();
        try {
            this.removeCanvas();
            clearInterval(this.rAF_ID);
            ((/** @type {?} */ (this.video.nativeElement.srcObject))).getTracks().forEach((/**
             * @param {?} track
             * @return {?}
             */
            function (track) {
                track.stop();
                AS_COMPLETE(as, true);
            }));
        }
        catch (error) {
            AS_COMPLETE(as, false, (/** @type {?} */ (error)));
        }
        return as;
    };
    /**
     * play
     * @return AsyncSubject
     */
    /**
     * play
     * @return {?} AsyncSubject
     */
    NgxScannerQrcodeComponent.prototype.play = /**
     * play
     * @return {?} AsyncSubject
     */
    function () {
        /** @type {?} */
        var as = new AsyncSubject();
        if (this.isPause) {
            this.video.nativeElement.play();
            this.requestAnimationFrame();
            AS_COMPLETE(as, true);
        }
        else {
            AS_COMPLETE(as, false);
        }
        return as;
    };
    /**
     * pause
     * @return AsyncSubject
     */
    /**
     * pause
     * @return {?} AsyncSubject
     */
    NgxScannerQrcodeComponent.prototype.pause = /**
     * pause
     * @return {?} AsyncSubject
     */
    function () {
        /** @type {?} */
        var as = new AsyncSubject();
        if (this.isStart) {
            clearInterval(this.rAF_ID);
            this.video.nativeElement.pause();
            AS_COMPLETE(as, true);
        }
        else {
            AS_COMPLETE(as, false);
        }
        return as;
    };
    /**
     * loadImage
     * @param src
     * @return AsyncSubject
     */
    /**
     * loadImage
     * @param {?} src
     * @return {?} AsyncSubject
     */
    NgxScannerQrcodeComponent.prototype.loadImage = /**
     * loadImage
     * @param {?} src
     * @return {?} AsyncSubject
     */
    function (src) {
        var _this = this;
        /** @type {?} */
        var as = new AsyncSubject();
        // Loading on
        this.status(false, true);
        // Set the src of this Image object.
        /** @type {?} */
        var image = new Image();
        // Setting cross origin value to anonymous
        image.setAttribute('crossOrigin', 'anonymous');
        // When our image has loaded.
        image.onload = (/**
         * @return {?}
         */
        function () {
            _this.drawImage(image, (/**
             * @param {?} flag
             * @return {?}
             */
            function (flag) {
                _this.status(false, false);
                AS_COMPLETE(as, flag);
            }));
        });
        // Set src
        image.src = src;
        return as;
    };
    /**
     * torcher
     * @return AsyncSubject
     */
    /**
     * torcher
     * @return {?} AsyncSubject
     */
    NgxScannerQrcodeComponent.prototype.torcher = /**
     * torcher
     * @return {?} AsyncSubject
     */
    function () {
        var _this = this;
        /** @type {?} */
        var as = this.applyConstraints({ torch: this.isTorch });
        as.subscribe((/**
         * @return {?}
         */
        function () { return false; }), (/**
         * @return {?}
         */
        function () { return _this.isTorch = !_this.isTorch; }));
        return as;
    };
    /**
     * applyConstraints
     * @return AsyncSubject
     */
    /**
     * applyConstraints
     * @param {?} constraints
     * @return {?} AsyncSubject
     */
    NgxScannerQrcodeComponent.prototype.applyConstraints = /**
     * applyConstraints
     * @param {?} constraints
     * @return {?} AsyncSubject
     */
    function (constraints) {
        var _this = this;
        /** @type {?} */
        var as = new AsyncSubject();
        /** @type {?} */
        var stream = (/** @type {?} */ (this.video.nativeElement.srcObject));
        /** @type {?} */
        var videoTrack = (/** @type {?} */ (stream.getVideoTracks()[0]));
        /** @type {?} */
        var imageCapture = new ((/** @type {?} */ (window))).ImageCapture(videoTrack);
        imageCapture.getPhotoCapabilities().then((/**
         * @return {?}
         */
        function () { return tslib_1.__awaiter(_this, void 0, void 0, function () {
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, videoTrack.applyConstraints((/** @type {?} */ ({ advanced: [constraints] })))];
                    case 1:
                        _a.sent();
                        AS_COMPLETE(as, true);
                        return [2 /*return*/];
                }
            });
        }); })).catch((/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            switch (error && error.name) {
                case 'NotFoundError':
                case 'DevicesNotFoundError':
                    AS_COMPLETE(as, false, (/** @type {?} */ ('Required track is missing')));
                    break;
                case 'NotReadableError':
                case 'TrackStartError':
                    AS_COMPLETE(as, false, (/** @type {?} */ ('Webcam or mic are already in use')));
                    break;
                case 'OverconstrainedError':
                case 'ConstraintNotSatisfiedError':
                    AS_COMPLETE(as, false, (/** @type {?} */ ('Constraints can not be satisfied by avb. devices')));
                    break;
                case 'NotAllowedError':
                case 'PermissionDeniedError':
                    AS_COMPLETE(as, false, (/** @type {?} */ ('Permission denied in browser')));
                    break;
                case 'TypeError':
                    AS_COMPLETE(as, false, (/** @type {?} */ ('Empty constraints object')));
                    break;
                default:
                    AS_COMPLETE(as, false, (/** @type {?} */ (error)));
                    break;
            }
        }));
        return as;
    };
    ;
    /**
     * getConstraints
     * @param deviceActive
     * @returns
     */
    /**
     * getConstraints
     * @return {?}
     */
    NgxScannerQrcodeComponent.prototype.getConstraints = /**
     * getConstraints
     * @return {?}
     */
    function () {
        /** @type {?} */
        var stream = (/** @type {?} */ (this.video.nativeElement.srcObject));
        /** @type {?} */
        var videoTrack = stream && (/** @type {?} */ (stream.getVideoTracks()[0]));
        return videoTrack && (/** @type {?} */ (videoTrack.getConstraints()));
    };
    /**
     * download
     * @param fileName
     * @return AsyncSubject
     */
    /**
     * download
     * @param {?=} fileName
     * @return {?} AsyncSubject
     */
    NgxScannerQrcodeComponent.prototype.download = /**
     * download
     * @param {?=} fileName
     * @return {?} AsyncSubject
     */
    function (fileName) {
        var _this = this;
        if (fileName === void 0) { fileName = "ngx-scanner-qrcode-" + Date.now() + ".png"; }
        /** @type {?} */
        var as = new AsyncSubject();
        /** @type {?} */
        var run = (/**
         * @return {?}
         */
        function () { return tslib_1.__awaiter(_this, void 0, void 0, function () {
            var blob, file;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, CANVAS_TO_BLOB(this.canvas.nativeElement)];
                    case 1:
                        blob = _a.sent();
                        file = BLOB_TO_FILE(blob, fileName);
                        FILES_TO_SCAN([file], this.config, as).subscribe((/**
                         * @param {?} res
                         * @return {?}
                         */
                        function (res) {
                            res.forEach((/**
                             * @param {?} item
                             * @return {?}
                             */
                            function (item) {
                                /** @type {?} */
                                var link = document.createElement('a');
                                link.href = item.url;
                                link.download = item.name;
                                link.click();
                                link.remove();
                            }));
                        }));
                        return [2 /*return*/];
                }
            });
        }); });
        run();
        return as;
    };
    /**
     * window: resize
     * Draw again!
     */
    /**
     * window: resize
     * Draw again!
     * @private
     * @return {?}
     */
    NgxScannerQrcodeComponent.prototype.resize = /**
     * window: resize
     * Draw again!
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        window.addEventListener("resize", (/**
         * @return {?}
         */
        function () {
            if (_this.dataForResize && _this.dataForResize.length) {
                DRAW_RESULT_APPEND_CHILD((/** @type {?} */ (_this.dataForResize)), _this.canvas.nativeElement, _this.resultsPanel.nativeElement);
            }
        }));
    };
    /**
     * Override config
     * @return void
     */
    /**
     * Override config
     * @private
     * @return {?} void
     */
    NgxScannerQrcodeComponent.prototype.overrideConfig = /**
     * Override config
     * @private
     * @return {?} void
     */
    function () {
        if (HAS_OWN_PROPERTY(this.config, 'src'))
            this.src = this.config.src;
        if (HAS_OWN_PROPERTY(this.config, 'fps'))
            this.fps = this.config.fps;
        if (HAS_OWN_PROPERTY(this.config, 'vibrate'))
            this.vibrate = this.config.vibrate;
        if (HAS_OWN_PROPERTY(this.config, 'decode'))
            this.decode = this.config.decode;
        if (HAS_OWN_PROPERTY(this.config, 'isBeep'))
            this.isBeep = this.config.isBeep;
        if (HAS_OWN_PROPERTY(this.config, 'deviceActive'))
            this.deviceActive = this.config.deviceActive;
        if (HAS_OWN_PROPERTY(this.config, 'constraints'))
            this.constraints = OVERRIDES('constraints', this.config, MEDIA_STREAM_DEFAULT);
    };
    /**
     * loadAllDevices
     */
    /**
     * loadAllDevices
     * @private
     * @param {?} as
     * @return {?}
     */
    NgxScannerQrcodeComponent.prototype.loadAllDevices = /**
     * loadAllDevices
     * @private
     * @param {?} as
     * @return {?}
     */
    function (as) {
        var _this = this;
        navigator.mediaDevices.enumerateDevices().then((/**
         * @param {?} devices
         * @return {?}
         */
        function (devices) {
            /** @type {?} */
            var cameraDevices = [];
            devices.forEach((/**
             * @param {?} f
             * @return {?}
             */
            function (f) { return f.kind == 'videoinput' && cameraDevices.push(f); }));
            _this.devices.next(cameraDevices);
            if (cameraDevices.length > 0) {
                /** @type {?} */
                var index = Math.max(0, (cameraDevices.length > _this.deviceActive ? _this.deviceActive : 0));
                _this.playDevice(cameraDevices[index].deviceId, as);
            }
            else {
                AS_COMPLETE(as, false, (/** @type {?} */ ('No camera detected.')));
            }
        }));
    };
    /**
     * drawImage
     * @param element
     * @param callback
     */
    /**
     * drawImage
     * @private
     * @param {?} element
     * @param {?=} callback
     * @return {?}
     */
    NgxScannerQrcodeComponent.prototype.drawImage = /**
     * drawImage
     * @private
     * @param {?} element
     * @param {?=} callback
     * @return {?}
     */
    function (element, callback) {
        if (callback === void 0) { callback = (/**
         * @return {?}
         */
        function () { }); }
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var canvas, ctx, imageData, code, EMIT_DATA;
            var _this = this;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        // Get the canvas element by using the getElementById method.
                        canvas = this.canvas.nativeElement;
                        // Get a 2D drawing context for the canvas.
                        ctx = (/** @type {?} */ (canvas.getContext('2d', { willReadFrequently: true })));
                        // HTMLImageElement size
                        if (element instanceof HTMLImageElement) {
                            canvas.width = element.naturalWidth;
                            canvas.height = element.naturalHeight;
                            element.style.visibility = '';
                            this.video.nativeElement.style.visibility = 'hidden';
                            this.video.nativeElement.style.height = canvas.offsetHeight + 'px';
                        }
                        // HTMLVideoElement size
                        if (element instanceof HTMLVideoElement) {
                            canvas.width = element.videoWidth;
                            canvas.height = element.videoHeight;
                            element.style.visibility = '';
                            this.canvas.nativeElement.style.visibility = 'hidden';
                        }
                        ctx.clearRect(0, 0, canvas.width, canvas.height);
                        // Draw image
                        ctx.drawImage(element, 0, 0, canvas.width, canvas.height);
                        // Data image
                        imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                        // Draw frame
                        return [4 /*yield*/, zbarWasm.scanImageData(imageData)];
                    case 1:
                        code = _a.sent();
                        if (code && code.length) {
                            // Decode
                            code.forEach((/**
                             * @param {?} s
                             * @return {?}
                             */
                            function (s) { return s.value = s.decode(_this.decode && _this.decode.toLocaleLowerCase()); }));
                            // Overlay
                            DRAW_RESULT_APPEND_CHILD(code, Object.freeze(this.canvas.nativeElement), this.resultsPanel.nativeElement);
                            // To blob and emit data
                            EMIT_DATA = (/**
                             * @return {?}
                             */
                            function () {
                                _this.eventEmit(code);
                                _this.dataForResize = code;
                            });
                            // HTMLImageElement
                            if (element instanceof HTMLImageElement) {
                                callback(true);
                                EMIT_DATA();
                                VIBRATE(this.vibrate);
                                PLAY_AUDIO(this.isBeep);
                            }
                            // HTMLVideoElement
                            if (element instanceof HTMLVideoElement) {
                                EMIT_DATA();
                                VIBRATE(this.vibrate);
                                PLAY_AUDIO(this.isBeep);
                            }
                        }
                        else {
                            callback(false);
                            this.removeCanvas();
                            this.dataForResize = code;
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    /**
     * removeCanvas
     */
    /**
     * removeCanvas
     * @private
     * @return {?}
     */
    NgxScannerQrcodeComponent.prototype.removeCanvas = /**
     * removeCanvas
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        Object.assign([], this.resultsPanel.nativeElement.childNodes).forEach((/**
         * @param {?} el
         * @return {?}
         */
        function (el) { return _this.resultsPanel.nativeElement.removeChild(el); }));
    };
    /**
     * status
     * @param isStart
     * @param isLoading
     */
    /**
     * status
     * @private
     * @param {?} isStart
     * @param {?} isLoading
     * @return {?}
     */
    NgxScannerQrcodeComponent.prototype.status = /**
     * status
     * @private
     * @param {?} isStart
     * @param {?} isLoading
     * @return {?}
     */
    function (isStart, isLoading) {
        this.isStart = isStart;
        this.isLoading = isLoading;
    };
    /**
     * eventEmit
     * @param response
     */
    /**
     * eventEmit
     * @private
     * @param {?=} response
     * @return {?}
     */
    NgxScannerQrcodeComponent.prototype.eventEmit = /**
     * eventEmit
     * @private
     * @param {?=} response
     * @return {?}
     */
    function (response) {
        if (response === void 0) { response = false; }
        (response !== false) && this.data.next(response || { data: null });
        (response !== false) && this.event.emit(response || { data: null });
    };
    /**
     * Single-thread
     * Loop Recording on Camera
     * Must be destroy request
     * Not using: requestAnimationFrame
     */
    /**
     * Single-thread
     * Loop Recording on Camera
     * Must be destroy request
     * Not using: requestAnimationFrame
     * @private
     * @return {?}
     */
    NgxScannerQrcodeComponent.prototype.requestAnimationFrame = /**
     * Single-thread
     * Loop Recording on Camera
     * Must be destroy request
     * Not using: requestAnimationFrame
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        this.rAF_ID = setInterval((/**
         * @return {?}
         */
        function () {
            if (_this.video.nativeElement.readyState === _this.video.nativeElement.HAVE_ENOUGH_DATA) {
                _this.drawImage(_this.video.nativeElement);
            }
        }), this.fps);
    };
    Object.defineProperty(NgxScannerQrcodeComponent.prototype, "isPause", {
        /**
         * Status of camera
         * @return boolean
         */
        get: /**
         * Status of camera
         * @return {?} boolean
         */
        function () {
            return this.isStart && this.video.nativeElement.paused;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    NgxScannerQrcodeComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.pause();
    };
    NgxScannerQrcodeComponent.decorators = [
        { type: Component, args: [{
                    selector: 'ngx-scanner-qrcode',
                    template: "<div #resultsPanel class=\"origin-overlay\"></div><canvas #canvas class=\"origin-canvas\"></canvas><video #video playsinline class=\"origin-video\"></video>",
                    host: { 'class': 'ngx-scanner-qrcode' },
                    exportAs: 'scanner',
                    inputs: ['src', 'fps', 'vibrate', 'decode', 'isBeep', 'deviceActive', 'config', 'constraints'],
                    outputs: ['event'],
                    queries: {
                        video: new ViewChild('video'),
                        canvas: new ViewChild('canvas'),
                        resultsPanel: new ViewChild('resultsPanel')
                    },
                    encapsulation: ViewEncapsulation.None,
                    styles: [".ngx-scanner-qrcode{display:block;position:relative}.origin-overlay{width:100%;position:absolute}.origin-overlay span{z-index:2;color:red;text-align:left;position:absolute}.origin-overlay .qrcode-polygon{z-index:1;position:absolute}.origin-canvas{width:100%;position:absolute}.origin-video{width:100%;background-color:#262626}.qrcode-tooltip{z-index:3;position:absolute}.qrcode-tooltip:hover .qrcode-tooltip-temp{display:block;position:absolute}.qrcode-tooltip-temp{bottom:0;left:50%;padding:5px;color:#fff;text-align:left;display:none;max-width:450px;border-radius:5px;width:-moz-max-content;width:max-content;word-wrap:break-word;transform:translate(-50%);transform-style:preserve-3d;background-color:#000000d0;box-shadow:1px 1px 20px #000000e0}"]
                }] }
    ];
    return NgxScannerQrcodeComponent;
}());
export { NgxScannerQrcodeComponent };
if (false) {
    /**
     * Element
     * playsinline required to tell iOS safari we don't want fullscreen
     * @type {?}
     */
    NgxScannerQrcodeComponent.prototype.video;
    /** @type {?} */
    NgxScannerQrcodeComponent.prototype.canvas;
    /** @type {?} */
    NgxScannerQrcodeComponent.prototype.resultsPanel;
    /**
     * EventEmitter
     * @type {?}
     */
    NgxScannerQrcodeComponent.prototype.event;
    /**
     * Input
     * @type {?}
     */
    NgxScannerQrcodeComponent.prototype.src;
    /** @type {?} */
    NgxScannerQrcodeComponent.prototype.fps;
    /** @type {?} */
    NgxScannerQrcodeComponent.prototype.vibrate;
    /** @type {?} */
    NgxScannerQrcodeComponent.prototype.decode;
    /** @type {?} */
    NgxScannerQrcodeComponent.prototype.isBeep;
    /** @type {?} */
    NgxScannerQrcodeComponent.prototype.deviceActive;
    /** @type {?} */
    NgxScannerQrcodeComponent.prototype.config;
    /** @type {?} */
    NgxScannerQrcodeComponent.prototype.constraints;
    /**
     * Export
     * @type {?}
     */
    NgxScannerQrcodeComponent.prototype.isStart;
    /** @type {?} */
    NgxScannerQrcodeComponent.prototype.isLoading;
    /** @type {?} */
    NgxScannerQrcodeComponent.prototype.isTorch;
    /** @type {?} */
    NgxScannerQrcodeComponent.prototype.data;
    /** @type {?} */
    NgxScannerQrcodeComponent.prototype.devices;
    /**
     * Private
     * @type {?}
     * @private
     */
    NgxScannerQrcodeComponent.prototype.rAF_ID;
    /**
     * @type {?}
     * @private
     */
    NgxScannerQrcodeComponent.prototype.dataForResize;
    /* Skipping unhandled member: ;*/
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXNjYW5uZXItcXJjb2RlLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25neC1zY2FubmVyLXFyY29kZS8iLCJzb3VyY2VzIjpbImxpYi9uZ3gtc2Nhbm5lci1xcmNvZGUuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBYyxZQUFZLEVBQXFCLFNBQVMsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUNySCxPQUFPLEVBQUUsZUFBZSxFQUFFLFlBQVksRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUNyRCxPQUFPLEVBQUUsV0FBVyxFQUFFLFlBQVksRUFBRSxjQUFjLEVBQUUsd0JBQXdCLEVBQUUsYUFBYSxFQUFFLGdCQUFnQixFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFFbkwsT0FBTyxFQUFFLGNBQWMsRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBR3BGO0lBQUE7UUF5QkU7O1dBRUc7UUFDSSxVQUFLLEdBQUcsSUFBSSxZQUFZLEVBQXlCLENBQUM7UUFFekQ7O1dBRUc7UUFDSSxRQUFHLEdBQXVCLGNBQWMsQ0FBQyxHQUFHLENBQUM7UUFDN0MsUUFBRyxHQUF1QixjQUFjLENBQUMsR0FBRyxDQUFDO1FBQzdDLFlBQU8sR0FBdUIsY0FBYyxDQUFDLE9BQU8sQ0FBQztRQUNyRCxXQUFNLEdBQXVCLGNBQWMsQ0FBQyxNQUFNLENBQUM7UUFDbkQsV0FBTSxHQUF3QixjQUFjLENBQUMsTUFBTSxDQUFDO1FBQ3BELGlCQUFZLEdBQXVCLGNBQWMsQ0FBQyxZQUFZLENBQUM7UUFDL0QsV0FBTSxHQUF3QixjQUFjLENBQUM7UUFDN0MsZ0JBQVcsR0FBNkMsY0FBYyxDQUFDLFdBQVcsQ0FBQztRQUUxRjs7V0FFRztRQUNJLFlBQU8sR0FBWSxLQUFLLENBQUM7UUFDekIsY0FBUyxHQUFZLEtBQUssQ0FBQztR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Q29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEVsZW1lbnRSZWYsIEV2ZW50RW1pdHRlciwgT25EZXN0cm95LCBPbkluaXQsIFZpZXdDaGlsZCwgVmlld0VuY2Fwc3VsYXRpb24gfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQmVoYXZpb3JTdWJqZWN0LCBBc3luY1N1YmplY3QgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgQVNfQ09NUExFVEUsIEJMT0JfVE9fRklMRSwgQ0FOVkFTX1RPX0JMT0IsIERSQVdfUkVTVUxUX0FQUEVORF9DSElMRCwgRklMRVNfVE9fU0NBTiwgSEFTX09XTl9QUk9QRVJUWSwgT1ZFUlJJREVTLCBQTEFZX0FVRElPLCBWSUJSQVRFIH0gZnJvbSAnLi9uZ3gtc2Nhbm5lci1xcmNvZGUuaGVscGVyJztcclxuaW1wb3J0IHsgU2Nhbm5lclFSQ29kZUNvbmZpZywgU2Nhbm5lclFSQ29kZURldmljZSwgU2Nhbm5lclFSQ29kZVJlc3VsdCwgU2Nhbm5lclFSQ29kZVNlbGVjdGVkRmlsZXMgfSBmcm9tICcuL25neC1zY2FubmVyLXFyY29kZS5vcHRpb25zJztcclxuaW1wb3J0IHsgQ09ORklHX0RFRkFVTFQsIE1FRElBX1NUUkVBTV9ERUZBVUxUIH0gZnJvbSAnLi9uZ3gtc2Nhbm5lci1xcmNvZGUuZGVmYXVsdCc7XHJcbmRlY2xhcmUgY29uc3QgemJhcldhc206IGFueTtcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnbmd4LXNjYW5uZXItcXJjb2RlJyxcclxuICB0ZW1wbGF0ZTogYDxkaXYgI3Jlc3VsdHNQYW5lbCBjbGFzcz1cIm9yaWdpbi1vdmVybGF5XCI+PC9kaXY+PGNhbnZhcyAjY2FudmFzIGNsYXNzPVwib3JpZ2luLWNhbnZhc1wiPjwvY2FudmFzPjx2aWRlbyAjdmlkZW8gcGxheXNpbmxpbmUgY2xhc3M9XCJvcmlnaW4tdmlkZW9cIj48L3ZpZGVvPmAsXHJcbiAgc3R5bGVVcmxzOiBbJy4vbmd4LXNjYW5uZXItcXJjb2RlLmNvbXBvbmVudC5zY3NzJ10sXHJcbiAgaG9zdDogeyAnY2xhc3MnOiAnbmd4LXNjYW5uZXItcXJjb2RlJyB9LFxyXG4gIGV4cG9ydEFzOiAnc2Nhbm5lcicsXHJcbiAgaW5wdXRzOiBbJ3NyYycsICdmcHMnLCAndmlicmF0ZScsICdkZWNvZGUnLCAnaXNCZWVwJywgJ2RldmljZUFjdGl2ZScsICdjb25maWcnLCAnY29uc3RyYWludHMnXSxcclxuICBvdXRwdXRzOiBbJ2V2ZW50J10sXHJcbiAgcXVlcmllczoge1xyXG4gICAgdmlkZW86IG5ldyBWaWV3Q2hpbGQoJ3ZpZGVvJyksXHJcbiAgICBjYW52YXM6IG5ldyBWaWV3Q2hpbGQoJ2NhbnZhcycpLFxyXG4gICAgcmVzdWx0c1BhbmVsOiBuZXcgVmlld0NoaWxkKCdyZXN1bHRzUGFuZWwnKVxyXG4gIH0sXHJcbiAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZVxyXG59KVxyXG5leHBvcnQgY2xhc3MgTmd4U2Nhbm5lclFyY29kZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95IHtcclxuXHJcbiAgLyoqXHJcbiAgICogRWxlbWVudFxyXG4gICAqIHBsYXlzaW5saW5lIHJlcXVpcmVkIHRvIHRlbGwgaU9TIHNhZmFyaSB3ZSBkb24ndCB3YW50IGZ1bGxzY3JlZW5cclxuICAgKi9cclxuICBwdWJsaWMgdmlkZW8hOiBFbGVtZW50UmVmPEhUTUxWaWRlb0VsZW1lbnQ+O1xyXG4gIHB1YmxpYyBjYW52YXMhOiBFbGVtZW50UmVmPEhUTUxDYW52YXNFbGVtZW50PjtcclxuICBwdWJsaWMgcmVzdWx0c1BhbmVsITogRWxlbWVudFJlZjxIVE1MRGl2RWxlbWVudD47XHJcblxyXG4gIC8qKlxyXG4gICAqIEV2ZW50RW1pdHRlclxyXG4gICAqL1xyXG4gIHB1YmxpYyBldmVudCA9IG5ldyBFdmVudEVtaXR0ZXI8U2Nhbm5lclFSQ29kZVJlc3VsdFtdPigpO1xyXG5cclxuICAvKipcclxuICAgKiBJbnB1dFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzcmM6IHN0cmluZyB8IHVuZGVmaW5lZCA9IENPTkZJR19ERUZBVUxULnNyYztcclxuICBwdWJsaWMgZnBzOiBudW1iZXIgfCB1bmRlZmluZWQgPSBDT05GSUdfREVGQVVMVC5mcHM7XHJcbiAgcHVibGljIHZpYnJhdGU6IG51bWJlciB8IHVuZGVmaW5lZCA9IENPTkZJR19ERUZBVUxULnZpYnJhdGU7XHJcbiAgcHVibGljIGRlY29kZTogc3RyaW5nIHwgdW5kZWZpbmVkID0gQ09ORklHX0RFRkFVTFQuZGVjb2RlO1xyXG4gIHB1YmxpYyBpc0JlZXA6IGJvb2xlYW4gfCB1bmRlZmluZWQgPSBDT05GSUdfREVGQVVMVC5pc0JlZXA7XHJcbiAgcHVibGljIGRldmljZUFjdGl2ZTogbnVtYmVyIHwgdW5kZWZpbmVkID0gQ09ORklHX0RFRkFVTFQuZGV2aWNlQWN0aXZlO1xyXG4gIHB1YmxpYyBjb25maWc6IFNjYW5uZXJRUkNvZGVDb25maWcgPSBDT05GSUdfREVGQVVMVDtcclxuICBwdWJsaWMgY29uc3RyYWludHM6IE1lZGlhU3RyZWFtQ29uc3RyYWludHMgfCBhbnkgfCB1bmRlZmluZWQgPSBDT05GSUdfREVGQVVMVC5jb25zdHJhaW50cztcclxuXHJcbiAgLyoqXHJcbiAgICogRXhwb3J0XHJcbiAgICovXHJcbiAgcHVibGljIGlzU3RhcnQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICBwdWJsaWMgaXNMb2FkaW5nOiBib29sZWFuID0gZmFsc2U7XHJcbiAgcHVibGljIGlzVG9yY2g6IGJvb2xlYW4gPSBmYWxzZTtcclxuICBwdWJsaWMgZGF0YSA9IG5ldyBCZWhhdmlvclN1YmplY3Q8U2Nhbm5lclFSQ29kZVJlc3VsdFtdPihbXSk7XHJcbiAgcHVibGljIGRldmljZXMgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PFNjYW5uZXJRUkNvZGVEZXZpY2VbXT4oW10pO1xyXG5cclxuICAvKipcclxuICAgKiBQcml2YXRlXHJcbiAgICovXHJcbiAgcHJpdmF0ZSByQUZfSUQ6IGFueTtcclxuICBwcml2YXRlIGRhdGFGb3JSZXNpemU6IFNjYW5uZXJRUkNvZGVSZXN1bHRbXSA9IFtdO1xyXG5cclxuICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgIHRoaXMub3ZlcnJpZGVDb25maWcoKTtcclxuICAgIGlmICh0aGlzLnNyYykge1xyXG4gICAgICB0aGlzLmxvYWRJbWFnZSh0aGlzLnNyYyk7XHJcbiAgICB9XHJcbiAgICB0aGlzLnJlc2l6ZSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogc3RhcnRcclxuICAgKiBAcmV0dXJuIEFzeW5jU3ViamVjdFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGFydCgpOiBBc3luY1N1YmplY3Q8YW55PiB7XHJcbiAgICBjb25zdCBhcyA9IG5ldyBBc3luY1N1YmplY3Q8YW55PigpO1xyXG4gICAgaWYgKHRoaXMuaXNTdGFydCkge1xyXG4gICAgICAvLyBSZWplY3RcclxuICAgICAgQVNfQ09NUExFVEUoYXMsIGZhbHNlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIG1lZGlhRGV2aWNlc1xyXG4gICAgICB0aGlzLmxvYWRBbGxEZXZpY2VzKGFzKTtcclxuICAgIH1cclxuICAgIHJldHVybiBhcztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHBsYXlEZXZpY2VcclxuICAgKiBAcGFyYW0gZGV2aWNlSWQgXHJcbiAgICogQHBhcmFtIGFzIFxyXG4gICAqIEByZXR1cm4gQXN5bmNTdWJqZWN0IFxyXG4gICAqL1xyXG4gIHB1YmxpYyBwbGF5RGV2aWNlKGRldmljZUlkOiBzdHJpbmcsIGFzOiBBc3luY1N1YmplY3Q8YW55PiA9IG5ldyBBc3luY1N1YmplY3Q8YW55PigpKTogQXN5bmNTdWJqZWN0PGFueT4ge1xyXG4gICAgY29uc3QgZXhpc3REZXZpY2VJZCA9IHRoaXMuaXNTdGFydCA/IHRoaXMuZ2V0Q29uc3RyYWludHMoKS5kZXZpY2VJZCAhPSBkZXZpY2VJZCA6IHRydWU7XHJcbiAgICBzd2l0Y2ggKHRydWUpIHtcclxuICAgICAgY2FzZSBkZXZpY2VJZCA9PSAnbnVsbCcgfHwgZGV2aWNlSWQgPT0gbnVsbDpcclxuICAgICAgICB0aGlzLnN0b3AoKTtcclxuICAgICAgICBBU19DT01QTEVURShhcywgZmFsc2UpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIGRldmljZUlkICYmIGV4aXN0RGV2aWNlSWQ6XHJcbiAgICAgICAgc3RvcCgpO1xyXG4gICAgICAgIHRoaXMuc3RvcCgpO1xyXG4gICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5yQUZfSUQpO1xyXG4gICAgICAgIC8vIExvYWRpbmcgb25cclxuICAgICAgICB0aGlzLnN0YXR1cyhmYWxzZSwgdHJ1ZSk7XHJcbiAgICAgICAgY29uc3QgY29uc3RyYWludHMgPSB7XHJcbiAgICAgICAgICBhdWRpbzogZmFsc2UsXHJcbiAgICAgICAgICB2aWRlbzogKHR5cGVvZiAodGhpcy5jb25zdHJhaW50cyAmJiB0aGlzLmNvbnN0cmFpbnRzLnZpZGVvKSA9PT0gJ2Jvb2xlYW4nKSA/IHsgZGV2aWNlSWQ6IGRldmljZUlkIH0gOiBPYmplY3QuYXNzaWduKHsgZGV2aWNlSWQ6IGRldmljZUlkIH0sIHRoaXMuY29uc3RyYWludHMgJiYgdGhpcy5jb25zdHJhaW50cy52aWRlbylcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZGV2aWNlQWN0aXZlID0gdGhpcy5kZXZpY2VzLnZhbHVlLmZpbmRJbmRleChmID0+IGYuZGV2aWNlSWQgPT0gZGV2aWNlSWQpO1xyXG4gICAgICAgIC8vIE1lZGlhU3RyZWFtXHJcbiAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpLnRoZW4oKHN0cmVhbTogTWVkaWFTdHJlYW0pID0+IHtcclxuICAgICAgICAgIHRoaXMudmlkZW8ubmF0aXZlRWxlbWVudC5zcmNPYmplY3QgPSBzdHJlYW07XHJcbiAgICAgICAgICB0aGlzLnZpZGVvLm5hdGl2ZUVsZW1lbnQub25sb2FkZWRtZXRhZGF0YSA9ICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy52aWRlby5uYXRpdmVFbGVtZW50LnBsYXkoKTtcclxuICAgICAgICAgICAgdGhpcy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKTtcclxuICAgICAgICAgICAgdGhpcy5zdGF0dXModHJ1ZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICBBU19DT01QTEVURShhcywgdHJ1ZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSkuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgICAgdGhpcy5zdGF0dXMoZmFsc2UsIGZhbHNlKTtcclxuICAgICAgICAgIHRoaXMuZXZlbnRFbWl0KGZhbHNlKTtcclxuICAgICAgICAgIEFTX0NPTVBMRVRFKGFzLCBmYWxzZSwgZXJyb3IpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIEFTX0NPTVBMRVRFKGFzLCBmYWxzZSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXM7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBzdG9wXHJcbiAgICogQHJldHVybiBBc3luY1N1YmplY3RcclxuICAgKi9cclxuICBwdWJsaWMgc3RvcCgpOiBBc3luY1N1YmplY3Q8YW55PiB7XHJcbiAgICB0aGlzLmV2ZW50RW1pdChudWxsKTtcclxuICAgIHRoaXMuc3RhdHVzKGZhbHNlLCBmYWxzZSk7XHJcbiAgICBjb25zdCBhcyA9IG5ldyBBc3luY1N1YmplY3Q8YW55PigpO1xyXG4gICAgdHJ5IHtcclxuICAgICAgdGhpcy5yZW1vdmVDYW52YXMoKTtcclxuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnJBRl9JRCk7XHJcbiAgICAgICh0aGlzLnZpZGVvLm5hdGl2ZUVsZW1lbnQuc3JjT2JqZWN0IGFzIE1lZGlhU3RyZWFtKS5nZXRUcmFja3MoKS5mb3JFYWNoKCh0cmFjazogYW55KSA9PiB7XHJcbiAgICAgICAgdHJhY2suc3RvcCgpO1xyXG4gICAgICAgIEFTX0NPTVBMRVRFKGFzLCB0cnVlKTtcclxuICAgICAgfSk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBBU19DT01QTEVURShhcywgZmFsc2UsIGVycm9yIGFzIGFueSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXM7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBwbGF5XHJcbiAgICogQHJldHVybiBBc3luY1N1YmplY3RcclxuICAgKi9cclxuICBwdWJsaWMgcGxheSgpOiBBc3luY1N1YmplY3Q8YW55PiB7XHJcbiAgICBjb25zdCBhcyA9IG5ldyBBc3luY1N1YmplY3Q8YW55PigpO1xyXG4gICAgaWYgKHRoaXMuaXNQYXVzZSkge1xyXG4gICAgICB0aGlzLnZpZGVvLm5hdGl2ZUVsZW1lbnQucGxheSgpO1xyXG4gICAgICB0aGlzLnJlcXVlc3RBbmltYXRpb25GcmFtZSgpO1xyXG4gICAgICBBU19DT01QTEVURShhcywgdHJ1ZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBBU19DT01QTEVURShhcywgZmFsc2UpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogcGF1c2VcclxuICAgKiBAcmV0dXJuIEFzeW5jU3ViamVjdCBcclxuICAgKi9cclxuICBwdWJsaWMgcGF1c2UoKTogQXN5bmNTdWJqZWN0PGFueT4ge1xyXG4gICAgY29uc3QgYXMgPSBuZXcgQXN5bmNTdWJqZWN0PGFueT4oKTtcclxuICAgIGlmICh0aGlzLmlzU3RhcnQpIHtcclxuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnJBRl9JRCk7XHJcbiAgICAgIHRoaXMudmlkZW8ubmF0aXZlRWxlbWVudC5wYXVzZSgpO1xyXG4gICAgICBBU19DT01QTEVURShhcywgdHJ1ZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBBU19DT01QTEVURShhcywgZmFsc2UpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogbG9hZEltYWdlXHJcbiAgICogQHBhcmFtIHNyYyBcclxuICAgKiBAcmV0dXJuIEFzeW5jU3ViamVjdFxyXG4gICAqL1xyXG4gIHB1YmxpYyBsb2FkSW1hZ2Uoc3JjOiBzdHJpbmcpOiBBc3luY1N1YmplY3Q8YW55PiB7XHJcbiAgICBjb25zdCBhcyA9IG5ldyBBc3luY1N1YmplY3Q8YW55PigpO1xyXG4gICAgLy8gTG9hZGluZyBvblxyXG4gICAgdGhpcy5zdGF0dXMoZmFsc2UsIHRydWUpO1xyXG4gICAgLy8gU2V0IHRoZSBzcmMgb2YgdGhpcyBJbWFnZSBvYmplY3QuXHJcbiAgICBjb25zdCBpbWFnZSA9IG5ldyBJbWFnZSgpO1xyXG4gICAgLy8gU2V0dGluZyBjcm9zcyBvcmlnaW4gdmFsdWUgdG8gYW5vbnltb3VzXHJcbiAgICBpbWFnZS5zZXRBdHRyaWJ1dGUoJ2Nyb3NzT3JpZ2luJywgJ2Fub255bW91cycpO1xyXG4gICAgLy8gV2hlbiBvdXIgaW1hZ2UgaGFzIGxvYWRlZC5cclxuICAgIGltYWdlLm9ubG9hZCA9ICgpID0+IHtcclxuICAgICAgdGhpcy5kcmF3SW1hZ2UoaW1hZ2UsIChmbGFnOiBib29sZWFuKSA9PiB7XHJcbiAgICAgICAgdGhpcy5zdGF0dXMoZmFsc2UsIGZhbHNlKTtcclxuICAgICAgICBBU19DT01QTEVURShhcywgZmxhZyk7XHJcbiAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8vIFNldCBzcmNcclxuICAgIGltYWdlLnNyYyA9IHNyYztcclxuICAgIHJldHVybiBhcztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHRvcmNoZXJcclxuICAgKiBAcmV0dXJuIEFzeW5jU3ViamVjdFxyXG4gICAqL1xyXG4gIHB1YmxpYyB0b3JjaGVyKCk6IEFzeW5jU3ViamVjdDxhbnk+IHtcclxuICAgIGNvbnN0IGFzID0gdGhpcy5hcHBseUNvbnN0cmFpbnRzKHsgdG9yY2g6IHRoaXMuaXNUb3JjaCB9KVxyXG4gICAgYXMuc3Vic2NyaWJlKCgpID0+IGZhbHNlLCAoKSA9PiB0aGlzLmlzVG9yY2ggPSAhdGhpcy5pc1RvcmNoKTtcclxuICAgIHJldHVybiBhcztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIGFwcGx5Q29uc3RyYWludHNcclxuICAgKiBAcmV0dXJuIEFzeW5jU3ViamVjdFxyXG4gICAqL1xyXG4gIHB1YmxpYyBhcHBseUNvbnN0cmFpbnRzKGNvbnN0cmFpbnRzOiBNZWRpYVRyYWNrQ29uc3RyYWludFNldCB8IGFueSk6IEFzeW5jU3ViamVjdDxhbnk+IHtcclxuICAgIGNvbnN0IGFzID0gbmV3IEFzeW5jU3ViamVjdDxhbnk+KCk7XHJcbiAgICBjb25zdCBzdHJlYW0gPSB0aGlzLnZpZGVvLm5hdGl2ZUVsZW1lbnQuc3JjT2JqZWN0IGFzIE1lZGlhU3RyZWFtO1xyXG4gICAgY29uc3QgdmlkZW9UcmFjayA9IHN0cmVhbS5nZXRWaWRlb1RyYWNrcygpWzBdIGFzIE1lZGlhU3RyZWFtVHJhY2s7XHJcbiAgICBjb25zdCBpbWFnZUNhcHR1cmUgPSBuZXcgKHdpbmRvdyBhcyBhbnkpLkltYWdlQ2FwdHVyZSh2aWRlb1RyYWNrKTtcclxuICAgIGltYWdlQ2FwdHVyZS5nZXRQaG90b0NhcGFiaWxpdGllcygpLnRoZW4oYXN5bmMgKCkgPT4ge1xyXG4gICAgICBhd2FpdCB2aWRlb1RyYWNrLmFwcGx5Q29uc3RyYWludHMoeyBhZHZhbmNlZDogW2NvbnN0cmFpbnRzXSB9IGFzIE1lZGlhVHJhY2tDb25zdHJhaW50cyk7XHJcbiAgICAgIEFTX0NPTVBMRVRFKGFzLCB0cnVlKTtcclxuICAgIH0pLmNhdGNoKChlcnJvcjogYW55KSA9PiB7XHJcbiAgICAgIHN3aXRjaCAoZXJyb3IgJiYgZXJyb3IubmFtZSkge1xyXG4gICAgICAgIGNhc2UgJ05vdEZvdW5kRXJyb3InOlxyXG4gICAgICAgIGNhc2UgJ0RldmljZXNOb3RGb3VuZEVycm9yJzpcclxuICAgICAgICAgIEFTX0NPTVBMRVRFKGFzLCBmYWxzZSwgJ1JlcXVpcmVkIHRyYWNrIGlzIG1pc3NpbmcnIGFzIGFueSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdOb3RSZWFkYWJsZUVycm9yJzpcclxuICAgICAgICBjYXNlICdUcmFja1N0YXJ0RXJyb3InOlxyXG4gICAgICAgICAgQVNfQ09NUExFVEUoYXMsIGZhbHNlLCAnV2ViY2FtIG9yIG1pYyBhcmUgYWxyZWFkeSBpbiB1c2UnIGFzIGFueSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdPdmVyY29uc3RyYWluZWRFcnJvcic6XHJcbiAgICAgICAgY2FzZSAnQ29uc3RyYWludE5vdFNhdGlzZmllZEVycm9yJzpcclxuICAgICAgICAgIEFTX0NPTVBMRVRFKGFzLCBmYWxzZSwgJ0NvbnN0cmFpbnRzIGNhbiBub3QgYmUgc2F0aXNmaWVkIGJ5IGF2Yi4gZGV2aWNlcycgYXMgYW55KTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ05vdEFsbG93ZWRFcnJvcic6XHJcbiAgICAgICAgY2FzZSAnUGVybWlzc2lvbkRlbmllZEVycm9yJzpcclxuICAgICAgICAgIEFTX0NPTVBMRVRFKGFzLCBmYWxzZSwgJ1Blcm1pc3Npb24gZGVuaWVkIGluIGJyb3dzZXInIGFzIGFueSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdUeXBlRXJyb3InOlxyXG4gICAgICAgICAgQVNfQ09NUExFVEUoYXMsIGZhbHNlLCAnRW1wdHkgY29uc3RyYWludHMgb2JqZWN0JyBhcyBhbnkpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgIEFTX0NPTVBMRVRFKGFzLCBmYWxzZSwgZXJyb3IgYXMgYW55KTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBhcztcclxuICB9O1xyXG5cclxuICAvKipcclxuICAgKiBnZXRDb25zdHJhaW50c1xyXG4gICAqIEBwYXJhbSBkZXZpY2VBY3RpdmUgXHJcbiAgICogQHJldHVybnMgXHJcbiAgICovXHJcbiAgcHVibGljIGdldENvbnN0cmFpbnRzKCk6IE1lZGlhVHJhY2tDb25zdHJhaW50U2V0IHwgYW55IHtcclxuICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMudmlkZW8ubmF0aXZlRWxlbWVudC5zcmNPYmplY3QgYXMgTWVkaWFTdHJlYW07XHJcbiAgICBjb25zdCB2aWRlb1RyYWNrID0gc3RyZWFtICYmIHN0cmVhbS5nZXRWaWRlb1RyYWNrcygpWzBdIGFzIE1lZGlhU3RyZWFtVHJhY2s7XHJcbiAgICByZXR1cm4gdmlkZW9UcmFjayAmJiB2aWRlb1RyYWNrLmdldENvbnN0cmFpbnRzKCkgYXMgYW55O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogZG93bmxvYWRcclxuICAgKiBAcGFyYW0gZmlsZU5hbWUgXHJcbiAgICogQHJldHVybiBBc3luY1N1YmplY3RcclxuICAgKi9cclxuICBwdWJsaWMgZG93bmxvYWQoZmlsZU5hbWU6IHN0cmluZyA9IGBuZ3gtc2Nhbm5lci1xcmNvZGUtJHtEYXRlLm5vdygpfS5wbmdgKTogQXN5bmNTdWJqZWN0PFNjYW5uZXJRUkNvZGVTZWxlY3RlZEZpbGVzW10+IHtcclxuICAgIGNvbnN0IGFzID0gbmV3IEFzeW5jU3ViamVjdDxhbnk+KCk7XHJcbiAgICBjb25zdCBydW4gPSBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCBDQU5WQVNfVE9fQkxPQih0aGlzLmNhbnZhcy5uYXRpdmVFbGVtZW50KTtcclxuICAgICAgY29uc3QgZmlsZSA9IEJMT0JfVE9fRklMRShibG9iLCBmaWxlTmFtZSk7XHJcbiAgICAgIEZJTEVTX1RPX1NDQU4oW2ZpbGVdLCB0aGlzLmNvbmZpZywgYXMpLnN1YnNjcmliZSgocmVzOiBTY2FubmVyUVJDb2RlU2VsZWN0ZWRGaWxlc1tdKSA9PiB7XHJcbiAgICAgICAgcmVzLmZvckVhY2goKGl0ZW06IFNjYW5uZXJRUkNvZGVTZWxlY3RlZEZpbGVzKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgICAgICAgbGluay5ocmVmID0gaXRlbS51cmw7XHJcbiAgICAgICAgICBsaW5rLmRvd25sb2FkID0gaXRlbS5uYW1lO1xyXG4gICAgICAgICAgbGluay5jbGljaygpO1xyXG4gICAgICAgICAgbGluay5yZW1vdmUoKVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIHJ1bigpO1xyXG4gICAgcmV0dXJuIGFzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogd2luZG93OiByZXNpemVcclxuICAgKiBEcmF3IGFnYWluIVxyXG4gICAqL1xyXG4gIHByaXZhdGUgcmVzaXplKCk6IHZvaWQge1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgKCkgPT4ge1xyXG4gICAgICBpZiAodGhpcy5kYXRhRm9yUmVzaXplICYmIHRoaXMuZGF0YUZvclJlc2l6ZS5sZW5ndGgpIHtcclxuICAgICAgICBEUkFXX1JFU1VMVF9BUFBFTkRfQ0hJTEQodGhpcy5kYXRhRm9yUmVzaXplIGFzIGFueSwgdGhpcy5jYW52YXMubmF0aXZlRWxlbWVudCwgdGhpcy5yZXN1bHRzUGFuZWwubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogT3ZlcnJpZGUgY29uZmlnXHJcbiAgICogQHJldHVybiB2b2lkXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBvdmVycmlkZUNvbmZpZygpOiB2b2lkIHtcclxuICAgIGlmIChIQVNfT1dOX1BST1BFUlRZKHRoaXMuY29uZmlnLCAnc3JjJykpIHRoaXMuc3JjID0gdGhpcy5jb25maWcuc3JjO1xyXG4gICAgaWYgKEhBU19PV05fUFJPUEVSVFkodGhpcy5jb25maWcsICdmcHMnKSkgdGhpcy5mcHMgPSB0aGlzLmNvbmZpZy5mcHM7XHJcbiAgICBpZiAoSEFTX09XTl9QUk9QRVJUWSh0aGlzLmNvbmZpZywgJ3ZpYnJhdGUnKSkgdGhpcy52aWJyYXRlID0gdGhpcy5jb25maWcudmlicmF0ZTtcclxuICAgIGlmIChIQVNfT1dOX1BST1BFUlRZKHRoaXMuY29uZmlnLCAnZGVjb2RlJykpIHRoaXMuZGVjb2RlID0gdGhpcy5jb25maWcuZGVjb2RlO1xyXG4gICAgaWYgKEhBU19PV05fUFJPUEVSVFkodGhpcy5jb25maWcsICdpc0JlZXAnKSkgdGhpcy5pc0JlZXAgPSB0aGlzLmNvbmZpZy5pc0JlZXA7XHJcbiAgICBpZiAoSEFTX09XTl9QUk9QRVJUWSh0aGlzLmNvbmZpZywgJ2RldmljZUFjdGl2ZScpKSB0aGlzLmRldmljZUFjdGl2ZSA9IHRoaXMuY29uZmlnLmRldmljZUFjdGl2ZTtcclxuICAgIGlmIChIQVNfT1dOX1BST1BFUlRZKHRoaXMuY29uZmlnLCAnY29uc3RyYWludHMnKSkgdGhpcy5jb25zdHJhaW50cyA9IE9WRVJSSURFUygnY29uc3RyYWludHMnLCB0aGlzLmNvbmZpZywgTUVESUFfU1RSRUFNX0RFRkFVTFQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogbG9hZEFsbERldmljZXNcclxuICAgKi9cclxuICBwcml2YXRlIGxvYWRBbGxEZXZpY2VzKGFzOiBBc3luY1N1YmplY3Q8YW55Pik6IHZvaWQge1xyXG4gICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzKCkudGhlbihkZXZpY2VzID0+IHtcclxuICAgICAgbGV0IGNhbWVyYURldmljZXM6IFNjYW5uZXJRUkNvZGVEZXZpY2VbXSA9IFtdO1xyXG4gICAgICBkZXZpY2VzLmZvckVhY2goZiA9PiBmLmtpbmQgPT0gJ3ZpZGVvaW5wdXQnICYmIGNhbWVyYURldmljZXMucHVzaChmKSk7XHJcbiAgICAgIHRoaXMuZGV2aWNlcy5uZXh0KGNhbWVyYURldmljZXMpO1xyXG4gICAgICBpZiAoY2FtZXJhRGV2aWNlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgY29uc3QgaW5kZXggPSBNYXRoLm1heCgwLCAoY2FtZXJhRGV2aWNlcy5sZW5ndGggPiB0aGlzLmRldmljZUFjdGl2ZSA/IHRoaXMuZGV2aWNlQWN0aXZlIDogMCkpO1xyXG4gICAgICAgIHRoaXMucGxheURldmljZShjYW1lcmFEZXZpY2VzW2luZGV4XS5kZXZpY2VJZCwgYXMpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIEFTX0NPTVBMRVRFKGFzLCBmYWxzZSwgJ05vIGNhbWVyYSBkZXRlY3RlZC4nIGFzIGFueSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogZHJhd0ltYWdlXHJcbiAgICogQHBhcmFtIGVsZW1lbnQgXHJcbiAgICogQHBhcmFtIGNhbGxiYWNrIFxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZHJhd0ltYWdlKGVsZW1lbnQ6IEhUTUxJbWFnZUVsZW1lbnQgfCBIVE1MVmlkZW9FbGVtZW50LCBjYWxsYmFjazogRnVuY3Rpb24gPSAoKSA9PiB7IH0pOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIC8vIEdldCB0aGUgY2FudmFzIGVsZW1lbnQgYnkgdXNpbmcgdGhlIGdldEVsZW1lbnRCeUlkIG1ldGhvZC5cclxuICAgIGNvbnN0IGNhbnZhcyA9IHRoaXMuY2FudmFzLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAvLyBHZXQgYSAyRCBkcmF3aW5nIGNvbnRleHQgZm9yIHRoZSBjYW52YXMuXHJcbiAgICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnLCB7IHdpbGxSZWFkRnJlcXVlbnRseTogdHJ1ZSB9KSBhcyBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQ7XHJcbiAgICAvLyBIVE1MSW1hZ2VFbGVtZW50IHNpemVcclxuICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgSFRNTEltYWdlRWxlbWVudCkge1xyXG4gICAgICBjYW52YXMud2lkdGggPSBlbGVtZW50Lm5hdHVyYWxXaWR0aDtcclxuICAgICAgY2FudmFzLmhlaWdodCA9IGVsZW1lbnQubmF0dXJhbEhlaWdodDtcclxuICAgICAgZWxlbWVudC5zdHlsZS52aXNpYmlsaXR5ID0gJyc7XHJcbiAgICAgIHRoaXMudmlkZW8ubmF0aXZlRWxlbWVudC5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XHJcbiAgICAgIHRoaXMudmlkZW8ubmF0aXZlRWxlbWVudC5zdHlsZS5oZWlnaHQgPSBjYW52YXMub2Zmc2V0SGVpZ2h0ICsgJ3B4JztcclxuICAgIH1cclxuICAgIC8vIEhUTUxWaWRlb0VsZW1lbnQgc2l6ZVxyXG4gICAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MVmlkZW9FbGVtZW50KSB7XHJcbiAgICAgIGNhbnZhcy53aWR0aCA9IGVsZW1lbnQudmlkZW9XaWR0aDtcclxuICAgICAgY2FudmFzLmhlaWdodCA9IGVsZW1lbnQudmlkZW9IZWlnaHQ7XHJcbiAgICAgIGVsZW1lbnQuc3R5bGUudmlzaWJpbGl0eSA9ICcnO1xyXG4gICAgICB0aGlzLmNhbnZhcy5uYXRpdmVFbGVtZW50LnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJztcclxuICAgIH1cclxuICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KVxyXG4gICAgLy8gRHJhdyBpbWFnZVxyXG4gICAgY3R4LmRyYXdJbWFnZShlbGVtZW50LCAwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xyXG4gICAgLy8gRGF0YSBpbWFnZVxyXG4gICAgY29uc3QgaW1hZ2VEYXRhID0gY3R4LmdldEltYWdlRGF0YSgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xyXG4gICAgLy8gRHJhdyBmcmFtZVxyXG4gICAgY29uc3QgY29kZSA9IGF3YWl0IHpiYXJXYXNtLnNjYW5JbWFnZURhdGEoaW1hZ2VEYXRhKTtcclxuICAgIGlmIChjb2RlICYmIGNvZGUubGVuZ3RoKSB7XHJcbiAgICAgIC8vIERlY29kZVxyXG4gICAgICBjb2RlLmZvckVhY2goKHM6IGFueSkgPT4gcy52YWx1ZSA9IHMuZGVjb2RlKHRoaXMuZGVjb2RlICYmIHRoaXMuZGVjb2RlLnRvTG9jYWxlTG93ZXJDYXNlKCkpKTtcclxuXHJcbiAgICAgIC8vIE92ZXJsYXlcclxuICAgICAgRFJBV19SRVNVTFRfQVBQRU5EX0NISUxEKGNvZGUsIE9iamVjdC5mcmVlemUodGhpcy5jYW52YXMubmF0aXZlRWxlbWVudCksIHRoaXMucmVzdWx0c1BhbmVsLm5hdGl2ZUVsZW1lbnQpO1xyXG5cclxuICAgICAgLy8gVG8gYmxvYiBhbmQgZW1pdCBkYXRhXHJcbiAgICAgIGNvbnN0IEVNSVRfREFUQSA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLmV2ZW50RW1pdChjb2RlKTtcclxuICAgICAgICB0aGlzLmRhdGFGb3JSZXNpemUgPSBjb2RlO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgLy8gSFRNTEltYWdlRWxlbWVudFxyXG4gICAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxJbWFnZUVsZW1lbnQpIHtcclxuICAgICAgICBjYWxsYmFjayh0cnVlKTtcclxuICAgICAgICBFTUlUX0RBVEEoKTtcclxuICAgICAgICBWSUJSQVRFKHRoaXMudmlicmF0ZSk7XHJcbiAgICAgICAgUExBWV9BVURJTyh0aGlzLmlzQmVlcCk7XHJcbiAgICAgIH1cclxuICAgICAgLy8gSFRNTFZpZGVvRWxlbWVudFxyXG4gICAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxWaWRlb0VsZW1lbnQpIHtcclxuICAgICAgICBFTUlUX0RBVEEoKTtcclxuICAgICAgICBWSUJSQVRFKHRoaXMudmlicmF0ZSk7XHJcbiAgICAgICAgUExBWV9BVURJTyh0aGlzLmlzQmVlcCk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNhbGxiYWNrKGZhbHNlKTtcclxuICAgICAgdGhpcy5yZW1vdmVDYW52YXMoKTtcclxuICAgICAgdGhpcy5kYXRhRm9yUmVzaXplID0gY29kZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHJlbW92ZUNhbnZhc1xyXG4gICAqL1xyXG4gIHByaXZhdGUgcmVtb3ZlQ2FudmFzKCk6IHZvaWQge1xyXG4gICAgT2JqZWN0LmFzc2lnbihbXSwgdGhpcy5yZXN1bHRzUGFuZWwubmF0aXZlRWxlbWVudC5jaGlsZE5vZGVzKS5mb3JFYWNoKGVsID0+IHRoaXMucmVzdWx0c1BhbmVsLm5hdGl2ZUVsZW1lbnQucmVtb3ZlQ2hpbGQoZWwpKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHN0YXR1c1xyXG4gICAqIEBwYXJhbSBpc1N0YXJ0IFxyXG4gICAqIEBwYXJhbSBpc0xvYWRpbmcgXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdGF0dXMoaXNTdGFydDogYm9vbGVhbiwgaXNMb2FkaW5nOiBib29sZWFuKTogdm9pZCB7XHJcbiAgICB0aGlzLmlzU3RhcnQgPSBpc1N0YXJ0O1xyXG4gICAgdGhpcy5pc0xvYWRpbmcgPSBpc0xvYWRpbmc7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBldmVudEVtaXRcclxuICAgKiBAcGFyYW0gcmVzcG9uc2UgXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBldmVudEVtaXQocmVzcG9uc2U6IGFueSA9IGZhbHNlKTogdm9pZCB7XHJcbiAgICAocmVzcG9uc2UgIT09IGZhbHNlKSAmJiB0aGlzLmRhdGEubmV4dChyZXNwb25zZSB8fCB7IGRhdGE6IG51bGwgfSk7XHJcbiAgICAocmVzcG9uc2UgIT09IGZhbHNlKSAmJiB0aGlzLmV2ZW50LmVtaXQocmVzcG9uc2UgfHwgeyBkYXRhOiBudWxsIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2luZ2xlLXRocmVhZFxyXG4gICAqIExvb3AgUmVjb3JkaW5nIG9uIENhbWVyYVxyXG4gICAqIE11c3QgYmUgZGVzdHJveSByZXF1ZXN0IFxyXG4gICAqIE5vdCB1c2luZzogcmVxdWVzdEFuaW1hdGlvbkZyYW1lXHJcbiAgICovXHJcbiAgcHJpdmF0ZSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKTogdm9pZCB7XHJcbiAgICB0aGlzLnJBRl9JRCA9IHNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgaWYgKHRoaXMudmlkZW8ubmF0aXZlRWxlbWVudC5yZWFkeVN0YXRlID09PSB0aGlzLnZpZGVvLm5hdGl2ZUVsZW1lbnQuSEFWRV9FTk9VR0hfREFUQSkge1xyXG4gICAgICAgIHRoaXMuZHJhd0ltYWdlKHRoaXMudmlkZW8ubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgIH1cclxuICAgIH0sIHRoaXMuZnBzKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0YXR1cyBvZiBjYW1lcmFcclxuICAgKiBAcmV0dXJuIGJvb2xlYW5cclxuICAgKi9cclxuICBnZXQgaXNQYXVzZSgpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLmlzU3RhcnQgJiYgdGhpcy52aWRlby5uYXRpdmVFbGVtZW50LnBhdXNlZDtcclxuICB9XHJcblxyXG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xyXG4gICAgdGhpcy5wYXVzZSgpO1xyXG4gIH1cclxufSJdfQ==